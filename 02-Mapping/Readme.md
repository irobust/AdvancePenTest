# Phase II: Mapping (Scanning and Enumeration)
## Nmap
* nmap [CIDR]
* nmap [CIDR] --exclude [IP Address]
* nmap -iL list.txt
* nmap [IP Address]
* nmap -p1-3000 [IP Address]
* nmap -p80,443 [IP Address]
* nmap -F [IP Address] `Fastmode จะ Scan เฉพาะ Famous port เท่านั้น`
* nmap --top-ports 10 [IP Address]
* nmap -sS [IP Address] `SYNC Scan`
* nmap -sT [IP Address] `Establish connection`
* nmap -Pn [IP Address] `สำหรับ server ที่ปิด ICMP`
* nmap -T0 [IP Address] `delay request ให้ช้าลงเพื่อหลบ IDS, IPS`
* nmap -O -sV --traceroute --script default [IP Address] `-sC same as --script default`
* nmap -A [IP Address] `same as above`
* nmap --script vuln,default [IP Address] `/usr/share/nmap/scripts/http-title.nse`
* nmap --script http-title [IP Address]
* nmap --script http-title --script-args="http-title.url=/sqli/example1.php" [IP Address]
* nmap -p80 --script "http-title"  [IP Address]
* nmap -p80 --script "http-title" --script-args "http-title.url=/sqli/example1.php" [IP Address]
* nmap -p80 --script "http-enum" -d [IP Address]
* nmap -p80 --script "http-enum" --script-args "http-enum-displayall=1"  -d [IP Address]

## Other Tools like nmap
* [zenmap](https://nmap.org/zenmap/)
* [angry scanner](https://angryip.org)
* [masscan](https://github.com/robertdavidgraham/masscan)
* [zmap](https://zmap.io)
* [SPARTA](https://tools.kali.org/information-gathering/sparta)

## Get Web Information
### Grab the Banner (Check technology stack)
1. Wappalyzer (Chrome Plug-in)
2. BuiltWith.com
3. whatweb example.com

## SSL Analysis
1. ssllabs.com
2. sslscan example.com
3. sslyze example.com --heartbleed --hsts
4. curl -I http://example.com

## Get Web Archetecture
### Virtual Host
* search with Bing.com `ip:"111.111.111.111"`
* [robtex.com](https://www.robtex.com)
* [Pentest Tools](https://pentest-tools.com/information-gathering/find-virtual-hosts)

### Load Balance
* lbd [domain-name]

### Web Application Firewall(WAF)
* wafw00f [domain-name]
* nmap -p80,443 --script "http-waf-detect" *Target Website*

### Web Spider and directory brute forcing
* OWASP ZAP (GUI)
* Burp suite (GUI)
* dirbuster (GUI)
* dirb http://10.0.2.4
* gobuster -u [URL] -w [Wordlist] -x php `ต้องติดตั้งเพิ่มด้วยคำสั่ง apt-get install gobuster`
* wfuzz --hc 404 -w [wordlist] http://10.0.2.4/FUZZ

## Vulnerability scanner
### OpenVAS Installation
1. sudo apt-get update
2. sudo apt install openvas gvm
3. sudo gvm-setup
3. sudo gvm-check-setup `ตรวจสอบสถานะของ openvas`

### Update NVT Database
```
sudo runuser -u _gvm -- greenbone-nvt-sync
```

### OpenVAS Management Daemon(gvmd or openvasmd)
* sudo gvmd --get-scanners
* sudo gvmd --get-users

Create scanner from command line
```
sudo gvmd --create-scanner=newscan2 \
    --scanner-host=192.168.1.14 \
    --scanner-port=80 \
    --scanner-type=OpenVAS Scanner
```

### Custom Profile
1. Clone profile "Full and Fast"
2. Edit new profile
3. Edit Policy
4. Edit CPE Policy Check 
5. Set single policy to `cpe:/a:microsoft:internet_explorer:9`
6. Save









	


